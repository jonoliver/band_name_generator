w = require('./words')
nouns = w.nouns
singular_nouns = w.singular_nouns
plural_nouns = w.plural_nouns
verbs = w.verbs
adjectives = w.adjectives
gerunds = w.gerunds
verbers = w.verbers
prepositions = w.prepositions
_ = require('underscore')
mixins = require('./mixins')
mixins.init(_)

Word = (collection, filter = _.noop()) -> _.chain(collection).filter(filter).sample().default("butt").value()
random_bool = -> Math.random() >= 0.5
starts_with_vowel = (w) -> w.match(/^[aeiou]/i)

module.exports = 
  Word: Word
  Alliteration: (word, type = Noun) -> type((w) -> w.charAt(0).toLowerCase() == word.charAt(0).toLowerCase())
  Noun: (filter) -> Word(nouns, filter)
  SingularNoun: (filter) -> Word(singular_nouns, filter)
  PluralNoun: (filter) -> Word(plural_nouns, filter)
  ShortNoun: (filter) -> Word(_(singular_nouns).filter((w) -> w.length < 7), filter)
  TinyNoun: (filter) -> Word(_(singular_nouns).filter((w) -> w.length < 4), filter)
  Verb: (filter) -> Word(verbs, filter)
  Verber: (filter) -> Word(verbers, filter)
  Gerund: (filter) -> Word(gerunds, filter)
  Adjective: (filter) -> Word(adjectives, filter)
  Preposition: (filter) -> Word(prepositions, filter)

  # Conditional Words
  An_A: (w) -> "#{if starts_with_vowel w then 'an' else 'a'} #{w}"
  Random_The: -> if random_bool() then "the " else ""

  # helpers
  starts_with_vowel: starts_with_vowel
  random_bool: random_bool